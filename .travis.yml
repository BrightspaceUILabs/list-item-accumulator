language: node_js
node_js: node
cache:
  npm: false
addons:
  chrome: stable
script:
- npm run lint
- |
  if [ $TRAVIS_PULL_REQUEST != false ] && [ $TRAVIS_SECURE_ENV_VARS == true ]; then
    echo "Pull request with secure environment variables, running Sauce tests...";
    npm run test:sauce || travis_terminate 1;
  else
    echo "Not a pull request and/or no secure environment variables, running headless tests...";
    npm run test:headless || travis_terminate 1;
  fi
after_success:
- frauci-update-version -d=skip && export TRAVIS_TAG=$(frauci-get-version)
env:
  global:
  - SAUCE_USERNAME: Desire2Learn
  - REPO_NAME=list-item-accumulator
  - OWNER_NAME=BrightspaceUILabs
deploy:
- provider: npm
  email: d2ltravisdeploy@d2l.com
  skip_cleanup: true
  api_key:
    #272d......8224
    - secure: EkTO6ZCGVx23bLvNVyVYBlDqc0dpV1cISDY6ONAeh1MrCGqN0c3KMHzZW1PrJkGtFMJ3W+tFv4cqMQI41yIpuGDLw3BQMp2JjJmENNPjvRlwucfDee0wKrpwzF0J1YVoyDgex8dQUNGGF3o9IQCB4fJD3wl9QDXDtItuYL7Ppke/Dq0eN19NiEkSLcmKfKZ/IqS4vROAihcIUozv2i6IbKJehv1G0vtIYIwpbXaC3cSJxHQU1DnlRZ2mTtnH9diqnS6t8TrTLn+KsOZHNEgncQ7A/hj480jts0XK06ROwFcFM/QRbBzKKINys0UiVH6GHSLJ/Ki49A9iywnnOpOX6xI9puRREv26sHyMmw/JJd/sACLGCu2JXgacSBWOgfUC+O0yvkDjiaxiEV2WtH+5XO2w3YQEhFbWDzT76BqMwSv2z5aspoXYFd5gr8rlRlwM/XzOqDB2ZWqiBm5RD+VrVPoKHaBOKIthXQZC/J2nryh4d8hAfG8jRQ2MB1xCxhZNHDA0OFM0MUdWrPaTkv0zxKnOp4TMfRg6FQSNf7InKF6sJfckAOpRhJDX8YMIJZ+AqXhSnRfUEbkp2lRlgKgrs0Cbbar4CpvJOal4DGj64is3x0c3EfaWsYWB9ju4LNVdEbDgRYSRBCJYj5SNy3e9Q5H4+JY55Wbbmy9VrxiedLI=
  on:
    tags: true
    repo: BrightspaceUILabs/list-item-accumulator
